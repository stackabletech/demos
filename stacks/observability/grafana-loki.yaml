# https://github.com/grafana/loki/tree/main/production/helm/loki
---
releaseName: loki
name: loki
repo:
  name: loki
  url: https://grafana.github.io/helm-charts
version: 6.19.0
options:
  loki:
    auth_enabled: false
    commonConfig:
      replication_factor: 1
    storage:
      type: 'filesystem'
    server:
      http_tls_config:
        cert_file: /etc/loki/certs/tls.crt
        key_file: /etc/loki/certs/tls.key
    readinessProbe:
      httpGet:
        scheme: HTTPS
  monitoring:
    dashboards:
      enabled: false
    rules:
      enabled: false
    serviceMonitor:
      enabled: false
    lokiCanary:
      enabled: false
    selfMonitoring:
      enabled: false
      grafanaAgent:
        installOperator: false
  test:
    enabled: false
  gateway:
    enabled: false
  singleBinary:
    replicas: 1
    extraVolumeMounts:
      # Mount the certificate generated by the secret-operator
      - name: tls
        mountPath: /etc/loki/certs/
    extraVolumes:
      # Request a TLS certificate from the secret-operator
      - name: tls
        ephemeral:
          volumeClaimTemplate:
            metadata:
              annotations:
                secrets.stackable.tech/class: tls
                # Add the service loki to the
                # distinguished names because this service is used
                # by opentelemetry-collector.
                secrets.stackable.tech/scope: |-
                  service=loki
            spec:
              storageClassName: secrets.stackable.tech
              accessModes:
                - ReadWriteOnce
              resources:
                requests:
                  storage: 1
