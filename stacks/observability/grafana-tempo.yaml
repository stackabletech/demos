# https://github.com/grafana/helm-charts/tree/main/charts/tempo
---
releaseName: tempo
name: tempo
repo:
  name: tempo
  url: https://grafana.github.io/helm-charts
version: 1.13.0
options:
  tempo:
    server:
      http_tls_config:
        cert_file: /etc/tempo/certs/tls.crt
        key_file: /etc/tempo/certs/tls.key
    receivers:
      otlp:
        protocols:
          grpc:
            endpoint: "0.0.0.0:4317"
            tls:
              cert_file: /etc/tempo/certs/tls.crt
              key_file: /etc/tempo/certs/tls.key
    extraVolumeMounts:
      # Mount the certificate generated by the secret-operator
      - name: tls
        mountPath: /etc/tempo/certs/
  tempoQuery:
    enabled: true
    extraVolumeMounts:
      # Mount the certificate generated by the secret-operator
      - name: tls
        mountPath: /etc/tempo/certs/
  extraVolumes:
    # Request a TLS certificate from the secret-operator
    - name: tls
      ephemeral:
        volumeClaimTemplate:
          metadata:
            annotations:
              secrets.stackable.tech/class: tls
              # Add the service loki to the
              # distinguished names because this service is used
              # by opentelemetry-collector.
              secrets.stackable.tech/scope: |-
                service=tempo
          spec:
            storageClassName: secrets.stackable.tech
            accessModes:
              - ReadWriteOnce
            resources:
              requests:
                storage: 1
